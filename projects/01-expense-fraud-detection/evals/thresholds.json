{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "System Thresholds and Targets",
  "description": "Operational thresholds for alerts and performance targets",
  "version": "1.0.0",
  "last_updated": "2025-01-01",

  "risk_score_thresholds": {
    "description": "리스크 점수 기반 액션 임계치",
    "levels": [
      {
        "range": [0, 29],
        "level": "GREEN",
        "action": "AUTO_APPROVE",
        "notification": []
      },
      {
        "range": [30, 49],
        "level": "YELLOW",
        "action": "LOG_ONLY",
        "notification": []
      },
      {
        "range": [50, 69],
        "level": "ORANGE",
        "action": "CREATE_CASE",
        "notification": ["MANAGER"],
        "sla_hours": 72
      },
      {
        "range": [70, 84],
        "level": "RED",
        "action": "HOLD_TRANSACTION",
        "notification": ["EMPLOYEE", "MANAGER"],
        "sla_hours": 12
      },
      {
        "range": [85, 99],
        "level": "CRITICAL",
        "action": "HOLD_TRANSACTION",
        "notification": ["EMPLOYEE", "MANAGER", "CFO"],
        "sla_hours": 4
      },
      {
        "range": [100, 100],
        "level": "BLACK",
        "action": "BLOCK_TRANSACTION",
        "notification": ["EMPLOYEE", "MANAGER", "COMPLIANCE"],
        "sla_hours": null
      }
    ]
  },

  "performance_targets": {
    "detection_accuracy": {
      "precision": {
        "target": 0.90,
        "yellow_threshold": 0.92,
        "red_threshold": 0.90,
        "unit": "ratio"
      },
      "recall": {
        "target": 0.85,
        "yellow_threshold": 0.87,
        "red_threshold": 0.85,
        "unit": "ratio"
      },
      "f1_score": {
        "target": 0.87,
        "yellow_threshold": 0.89,
        "red_threshold": 0.87,
        "unit": "ratio"
      },
      "false_positive_rate_black": {
        "target": 0.005,
        "yellow_threshold": 0.003,
        "red_threshold": 0.005,
        "unit": "ratio"
      },
      "false_positive_rate_gray": {
        "target": 0.10,
        "yellow_threshold": 0.07,
        "red_threshold": 0.10,
        "unit": "ratio"
      }
    },
    "latency": {
      "realtime_blocking_p95": {
        "target": 1000,
        "yellow_threshold": 800,
        "red_threshold": 1000,
        "unit": "milliseconds"
      },
      "case_creation_p95": {
        "target": 300000,
        "yellow_threshold": 240000,
        "red_threshold": 300000,
        "unit": "milliseconds"
      }
    },
    "business_impact": {
      "recovery_prevention_monthly": {
        "target": 10000000,
        "yellow_threshold": 7000000,
        "red_threshold": 5000000,
        "unit": "KRW",
        "description": "월간 회수액 + 방지액"
      },
      "repeat_offender_rate": {
        "target": 0.05,
        "yellow_threshold": 0.07,
        "red_threshold": 0.10,
        "unit": "ratio"
      }
    },
    "operational": {
      "sla_compliance_rate": {
        "target": 0.90,
        "yellow_threshold": 0.92,
        "red_threshold": 0.90,
        "unit": "ratio"
      },
      "receipt_submission_rate": {
        "target": 0.90,
        "yellow_threshold": 0.85,
        "red_threshold": 0.80,
        "unit": "ratio"
      },
      "tax_tagging_accuracy": {
        "target": 0.95,
        "yellow_threshold": 0.97,
        "red_threshold": 0.95,
        "unit": "ratio"
      }
    }
  },

  "policy_thresholds": {
    "receipt_required_amount": {
      "value": 100000,
      "currency": "KRW",
      "description": "이 금액 이상 거래는 영수증 필수"
    },
    "receipt_deadline_hours": {
      "value": 72,
      "description": "영수증 제출 기한 (거래 후)"
    },
    "location_mismatch_radius_km": {
      "value": 50,
      "description": "근무지와 이 거리 이상 떨어진 거래는 위치 불일치로 판단"
    },
    "split_payment_detection": {
      "time_window_minutes": 30,
      "count_threshold": 3,
      "description": "30분 내 동일 가맹점 3건 이상은 분할 결제로 의심"
    },
    "rapid_spending_multiplier": {
      "value": 3.0,
      "description": "30일 평균 대비 3배 이상 지출 시 급증으로 판단"
    }
  },

  "alert_thresholds": {
    "critical_alerts": [
      {
        "metric": "precision",
        "condition": "< 0.90",
        "message": "정밀도가 목표치 이하입니다. 정책 리뷰가 필요합니다.",
        "recipients": ["CFO", "Finance Team Lead"]
      },
      {
        "metric": "black_mcc_blocking_rate",
        "condition": "< 1.0",
        "message": "블랙 MCC 차단율이 100%가 아닙니다. 시스템 점검이 필요합니다.",
        "recipients": ["CTO", "Compliance Team"]
      },
      {
        "metric": "system_availability",
        "condition": "< 0.999",
        "message": "시스템 가용성이 99.9% 이하입니다.",
        "recipients": ["CTO", "IT Team"]
      }
    ],
    "warning_alerts": [
      {
        "metric": "false_positive_rate_gray",
        "condition": "> 0.07",
        "message": "그레이 오탐률이 상승했습니다. 임계치 조정을 검토하세요.",
        "recipients": ["Finance Team Lead"]
      },
      {
        "metric": "receipt_submission_rate",
        "condition": "< 0.85",
        "message": "영수증 제출율이 저조합니다. 독려 캠페인을 시작하세요.",
        "recipients": ["Finance Team"]
      },
      {
        "metric": "sla_compliance_rate",
        "condition": "< 0.92",
        "message": "SLA 준수율이 목표치를 하회합니다. 인력 증원을 검토하세요.",
        "recipients": ["Finance Team Lead"]
      }
    ]
  },

  "tuning_history": [
    {
      "version": "1.0.0",
      "date": "2025-01-01",
      "changes": [
        {
          "parameter": "risk_score_threshold_case_creation",
          "old_value": 60,
          "new_value": 50,
          "reason": "골든셋 테스트 결과 재현율 향상을 위해 임계치 하향"
        }
      ],
      "results": {
        "precision_before": 0.88,
        "precision_after": 0.91,
        "recall_before": 0.82,
        "recall_after": 0.87
      }
    }
  ],

  "ab_test_config": {
    "enabled": false,
    "description": "A/B 테스트 활성화 여부",
    "current_tests": []
  },

  "escalation_rules": {
    "case_severity": {
      "CRITICAL": {
        "sla_hours": 4,
        "escalate_to": "CFO",
        "escalate_if_no_response_hours": 2
      },
      "HIGH": {
        "sla_hours": 12,
        "escalate_to": "Finance Team Lead",
        "escalate_if_no_response_hours": 6
      },
      "MEDIUM": {
        "sla_hours": 72,
        "escalate_to": "Manager",
        "escalate_if_no_response_hours": 48
      }
    },
    "repeat_offenders": {
      "threshold_count": 3,
      "threshold_period_days": 90,
      "escalate_to": "HR + CFO",
      "action": "강제 면담 + 징계 검토"
    }
  },

  "spending_limits": {
    "by_position": {
      "사원": {
        "daily": 300000,
        "monthly": 3000000
      },
      "대리": {
        "daily": 500000,
        "monthly": 5000000
      },
      "과장": {
        "daily": 1000000,
        "monthly": 10000000
      },
      "부장": {
        "daily": 2000000,
        "monthly": 20000000
      },
      "임원": {
        "daily": 5000000,
        "monthly": 50000000
      }
    },
    "high_amount_threshold": {
      "value": 1000000,
      "currency": "KRW",
      "action": "100만원 이상 거래는 추가 검토",
      "require_pre_approval": true
    }
  }
}
